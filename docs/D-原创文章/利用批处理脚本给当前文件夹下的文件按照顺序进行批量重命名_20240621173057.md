---
cdate: 2024-06-21 17:30
tags: 原创文章 
---

# 利用批处理脚本给当前文件夹下的文件按照顺序进行批量重命名

有时候我们在网上下载下来的电视剧或者网课每集的名字里都带着乱七八糟的广告，导致我们想要看具体第几集的时候很难找到。基于以上痛点我写了个小小的批处理脚本来给当前文件夹当中的所有文件进行批量重命名，最终效果是按照当前文件夹的顺序从 001 开始往下依次给文件重命名，接下来请跟我一步一步实现它吧！

第一步：在需要重命名的文件夹下新建空白 `.txt` 文件。

第二步：将以下代码复制到新建的 `.txt` 文件中并保存。

```batch
@echo off
setlocal enabledelayedexpansion

:: 获取当前批处理文件的名称
set "batfile=%~nx0"

:: 初始化计数器
set /a counter=1

:: 获取当前时间并格式化为时间戳
for /f "tokens=2 delims==" %%I in ('"wmic os get localdatetime /value"') do set datetime=%%I
set "timestamp=%datetime:~0,4%%datetime:~4,2%%datetime:~6,2%_%datetime:~8,2%%datetime:~10,2%%datetime:~12,2%"

:: 遍历当前文件夹中的所有文件
for %%f in (*.*) do (
    :: 跳过当前批处理文件
    if "%%f" neq "%batfile%" (
        :: 格式化计数器为三位数
        set "newname=000!counter!"
        set "newname=!newname:~-3!"
        :: 获取文件扩展名（如果有）
        set "ext=%%~xf"
        if "!ext!"=="" set "ext="
        :: 重命名文件
        ren "%%f" "!newname!_!timestamp!!ext!"
        :: 增加计数器
        set /a counter+=1
        :: 更新时间戳以确保唯一性
        for /f "tokens=2 delims==" %%I in ('"wmic os get localdatetime /value"') do set datetime=%%I
        set "timestamp=%datetime:~0,4%%datetime:~4,2%%datetime:~6,2%_%datetime:~8,2%%datetime:~10,2%%datetime:~12,2%"
    )
)

echo 完成重命名!

```

第三步：将这个新建的文件后缀名 `.txt` 改为 `.bat` 并保存。

第四步：双击这个 `.bat` 结尾的文件，稍等一会发现所有文件重命名完成。注意：为了避免文件名称重复，我们利用系统时间戳生成了格式为 `001_yyyyMMdd_HHmmss` 的独一无二的文件名

第五步：删除这个 `.bat` 结尾的文件，大功告成！